# SPD-DDPM
This is code for AAAI2024 paper SPD-DDPM:Denoising Diffusion Probabilistic Models in SPD Space. Paper is in https://arxiv.org/abs/2312.08200.

File ddpm_uncondition is the code for unconditional SPD ddpm. ddpm.py is the main script. You can use generate_train_sample_setting1.py to generate training samples, using ddpm_test_setting1.py to generate test samples.

File ddpm_condition is the code for conditional SPD ddpm. ddpm.py is the main file. Ypu can use test.py to generate test samples.

heatplot.py in exp1 is the script to draw heatplot.

File exp2 is code for generative regression. frechet_mean.R compute the frechet mean of SPD matrices. conditional_dis.py compute forbenius and affine-invariant distance. Nearest_SPD.R calculate the nearest SPD matrices.


File DATA contains data of SPD ddpm.

In file condition, train_data.csv is the training data, first 13 columns are predictor. test_y.csv is predictor for testing and test_spds.csv is the true SPD matrices. ddpm_spds_list.csv is generated by SPD-DDPM. eud_ddpm_spds_mean is generated by ddpm. data_1.csv is prediction of frechet regression, data_2.csv is prediction of SPD ddpm, data_3 is the nearest SPD matrices of eud_ddpm_spds_mean. data_true is the true SPD matrices. 

In file uncondition, exp1_setting_init.csv is the mean of gussian distribution. train_sample.csv is the training sample. generated_samples_ddpm.csv is generated by ddpm. generated_samples_spd_ddpm.csv is generated by SPD-DDPM.

